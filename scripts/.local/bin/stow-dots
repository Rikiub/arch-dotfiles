#/usr/bin/env sh

DOTFILES_DIR="$HOME/dotfiles"
GIT_DIR="--work-tree=$DOTFILES_DIR"

INSTALL_DOTS="default scripts fish sway-rice i3"

if [ "$1" = "sync" ]; then
	# find and delete broken symlinks
	find ~/.config -xtype l -delete
	find ~/.local -xtype l -delete

	# sync stow files
	stow --dotfiles --dir="$DOTFILES_DIR" --target="$HOME" \
	$INSTALL_DOTS

	# check is stow return error
	if [ $? -ne 0 ]; then
		exit 1
	fi

	echo "> Completed dotfiles sync"
	
elif [ "$1" = "push" ]; then
	echo "> Starting git"

	# push to my github account
	git $GIT_DIR add .
	git $GIT_DIR commit -m "update"
	git $GIT_DIR push

else
	echo "ERROR: Arguments no provided"

fi
